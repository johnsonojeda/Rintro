---
title: "Importing and Exporting data files"
author: "EcoHealth Alliance"
date: "March 2, 2016"
output: html_document
---

<img src = "rlogo.png" style="position:absolute;top:0px;left:0px;"/>

## Contents
[**Importing**](#imp)

[CSV files](#icsv)

[TXT files](#itxt)

[Excel spreadsheet](#ixls)

[SPSS](#ispss)

[Stata](#istata)

[SAS](#isas)

[**Exporting**](#exp)
[CSV files](#ecsv)

[TXT files](#etxt)

[Excel spreadsheet](#exls)

[SPSS](#espss)

[Stata](#estata)

[SAS](#esas)

## <a name = "imp"><a/>Importing
We might want to import data stored in other formats (e.g. CSV, SAS, Excel) for analysis in R. 

### <a name = "icsv"><a/>CSV files 
To import csv files we can use the *read.csv*() function.

``` {r}
data = read.csv("MyData.csv", header= TRUE, sep = ",")
```
Note that ```header = TRUE``` is indicating that the first row of the dataframe should not be considered as part of the data since it holds variable names. If this is not the case for your data then you would set ```header = FALSE``` within the function.

The *sep* parameter indicates the delimiter that should be considered when separating your data into columns. Since this is a **Comma separated value** file, the delimter we set ```sep = "," ```.

### <a name = "itxt"><a/>TXT files

Flat text files can be imported into R using *read.table*() 

```{r} 
data = read.table("MyData.txt, header = TRUE, sep = "\t")
```
*read.table*() is a generalized version of *read.csv*() and can also be used to import CSV files. In this case data was tabulated so we set ```sep = "\t"``` as the delimiter. 

### <a name = "ixls"><a/>Excel spreadsheet 

We must first load the *xlsx* library 

```
library(xlsx)
read.xlsx("MyData.xlsx", sheetIndex = 1, header = TRUE)
```
The ```sheetIndex = 1``` parameter is indicating that the first sheet of the workbook is to be imported as a dataframe. If you wish to load information from another sheet you may either indicate its index or alternatively its name.

```
read.xlsx("MyData.xlsx", sheetName = "Sheet2", header = TRUE)
```
The *header* parameter indicates whether the first row of the dataframes contains variable names/labels (TRUE) or not (FALSE). 

### <a name = "ispss"><a/>SPSS 
R can import SPSS data sets with the *read.spss*() function from the *foreign* package. 

```{r}
# Load the foreign package
librar(foreign)
data = read.spss("MyData.sav", use.value.label = TRUE, to.data.frame = TRUE)
```
```use.value.label = TRUE``` converts all variables with labels in SPSS into factors in R, while ```to.data.frame = TRUE``` converts the data into an R dataframe. 

Alternatively, we can use the *spss.get*() function from the *Hmisc* package. 

```{r}
install.packages("Hmisc") #if not previously installed
library(Hmisc)
data = spss.get("MyData.sav", use.value.label = TRUE)
```
Keep in midne that *foreign* is a default library to R, *Hmisc* must be installed before loading.

### <a name = "istata"><a/>Stata

To import Stata files we will also use the *foreign* package and its *read.dta*() function.
```{r} 
data = read.dta("MyData.dta")
```
###<a name = "isas"><a/> SAS

There are different ways in which you can import SAS files into R, however the most convinient is to export your SAS dataset into CSV and then import it using the *read.csv*() function as mentioned previously. 

Another way you can import your SAS data is by using the *sasxport.get*() function from the *Hmisc* library

```{r}
data = sasxport.get("MyData.xpt")
```
***
##<a name = "exp"><a/> Exporting
Exporting dataframes or result tables from R to other formats is also possible.

### <a name = "ecsv"><a/>CSV files 
Exporting csv files from R can be done using the *write.csv*() function. 
```
write.csv(data, file = "MyData.csv")
```
Note that by default your files will be saved in your working directory. If you wish to save these somewhere else you *must* specify the file path. For example:

```
write.csv(data, file = "C:/MyFilePath/MyData.csv")
```
### <a name = "etxt"><a/>TXT
Exporting to a generic txt file is similar to exporting csv files. In this case we will use the *write.table*() command.
```
write.table(data, file = "MyData.txt", sep = "\t")
```
Note that we have set ```sep = "\t"``` and thus have created a tabulated file. We could have created a csv file by setting the *sep* parameter to ",". 

### <a name = "exls"><a/>Excel spreadsheet 

To export dataframes to excel spreadsheets we must load the *xlsx* package.

```
library(xlsx)
write.xlsx(data, "MyData.xlsx")
```

### <a name = "ispss"><a/>SPSS
As with importing, the *foreign* library is necessary to export SPSS file via its *write.foreign*() function. 
```
write.foreign(data, datafile = "MyData.txt", codefile = "MyData.sps", package = "SPSS")
```

### <a name = "istata"><a/>Stata
The *foreign* package is also required to export Stata files. *write.dta*() can be used to export dataframes in Stata binary format

```
write.dta(data, "MyData.dta")
```
### <a name = "isas"><a/>SAS
The *write.foreign*() function from *foreign* can also be used to export dataframes in SAS format in a similar way to SPSS files.
````
write.foreign(data, datafile = "MyData.txt", codefile = "MyData.sas", package = "SAS")
```



